<link rel="stylesheet" href="/admin/css/user_02.css"/>
<header id="header" class="link01" data-partial="/admin/_common/header.html" data-name="Header"></header>

<div id="mainContents">
    <div class="guiBase">
        <div><input type="search" id="asId" placeholder="ID"></div>
        <div><input type="search" id="userNo" placeholder="ユーザーNo"></div>
        <div><input type="search" id="castName" placeholder="キャバ嬢名"></div>
        <div data-widget="Show" data-param="loading" data-condition="false">
            <input type="button" value="検索" onclick="self.search();">
            {{errorMessage|$span}}
        </div>
        <div data-widget="Show" data-param="loading" data-condition="true">
<<<<<<< HEAD
            <img src="/admin/img/loading.gif" />
=======
            <img src="/admin/img/loading.gif"/>
>>>>>>> 94264d7691e80ac3a3d920ab7321a655f9ef8912
        </div>
    </div>
    <div id="listBase">
        <div class="textBox">
        <p>アバター</p>
        <div class="textBoxIn" id="status" style="width: 320px; height: 610px;"></div>
        <br/>
        <p>自己紹介</p>
        <div class="textBoxIn" data-widget="Show" data-param="autoBindFlag" data-condition="true">{{user.profile | decode | nl2br}}</div>
        </div>
        <span data-widget="Show" data-param="autoBindFlag" data-condition="true">
        <div>ログイン</div>
            <ul class="userTitle">
                <li>登録日時</li>
                <li>{{ user.registeredAt | $date format:'mm/dd hh:mm' }}</li>
            </ul>
            <ul class="userTitle">
                <li>最終ログイン</li>
                <li>{{user.wallet.lastLoginAt | $date format:'mm/dd hh:mm' }}</li>
            </ul>
            <ul class="userTitle">
                <li>招待者</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>チュートリアル</li>
                <li>{{ user.tutorial.updatedAt | $date format:'mm/dd hh:mm' }}</li>
            </ul>
        <div>基本情報</div>
            <ul class="userTitle">
                <li>ユーザーNo</li>
                <li>{{ user.no }}</li>
            </ul>
            <ul class="userTitle">
                <li>源氏名</li>
                <li>{{user.castName|decode}}</li>
            </ul>
            <ul class="userTitle">
                <li>レベル</li>
                <li>{{user.level}}</li>
            </ul>
            <ul class="userTitle">
                <li>アゲ</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>モリ</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>ツヤ</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>キャバ友</li>
                <li>{{user.friendCount}}/{{user.maxFriendCount}}</li>
            </ul>
            <ul class="userTitle">
                <li>ドレス数</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>ドレスレア度</li>
                <li>-</li>
            </ul>
            <ul class="userTitle">
                <li>CASH</li>
                <li>{{user.wallet.moneyGC | comma}}</li>
            </ul>
            <ul class="userTitle">
                <li>キャバコイン</li>
                <li>{{user.wallet.moneyPC | comma}}</li>
            </ul>
            <ul class="userTitle">
                <li>極嬢pt</li>
                <li>{{user.wallet.point | comma}}</li>
            </ul>
        <div>ステータス</div>
            <!-- list -->
            <ul class="userTitle">
                <li>体力</li>
                <li>{{user.parameter.hp}}/{{user.parameter.maxHp}}</li>
            </ul>
            <ul class="userTitle">
                <li>魅力</li>
                <li>{{user.parameter.mp}}/{{user.parameter.maxMp}}</li>
            </ul>
            <ul class="userTitle">
                <li>あいさつ回数</li>
                <li>-</li>
            </ul>
        <div>在籍店舗</div>
        <span data-widget="Repeat" data-item="shift" data-from="shifts">
            <ul class="userTitle">
                <li>{{shift.open|opentime}}</li>
                <li><a href="#!/admin/club/detail.html?={{shift.id}}">{{shift.name}}</a></li>
                <li>{{shift.uid}}</li>
            </ul>
        </span>
        <div>経営店舗</div>
        <span data-widget="Repeat" data-item="manage" data-from="manages">
            <ul class="userTitle">
                <li>{{shift.uid}}</li>
                <li>{{shift.name}}</li>
            </ul>
        </span>
        <div>回復アイテム</div>
        <ul class="userTitle">
            <li>体力</li>
            <li>{{user.parameter.item1 | comma}}</li>
        </ul>
        <ul class="userTitle">
            <li>魅力</li>
            <li>{{user.parameter.item2 | comma}}</li>
        </ul>
        <div>ガチャチケ</div>
        <ul class="userTitle">
            <li>プレミアムドレス</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>Rドレス専用</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>HRドレス専用</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>SRドレス専用</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>プレミアムボトル</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>Rボトル専用</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>HRボトル専用</li>
            <li>-</li>
        </ul>
        <ul class="userTitle">
            <li>SRボトル専用</li>
            <li>-</li>
        </ul>
        </span>
    </div>
</div>

<script type="text/javascript">
$controller = function() {
    var self = this;
    self.autoBindFlag = true;
<<<<<<< HEAD
    self.loading = false;
    self.errorMessage = '';
=======
    self.errorMessage = '';
    self.loading = false;
>>>>>>> 94264d7691e80ac3a3d920ab7321a655f9ef8912
    var searchUser = function() {
        var castName = $tenjoh.Util.encode(document.getElementById('castName').value);
        var asId = $tenjoh.Util.encode(document.getElementById('asId').value);
        self.loading = true;
        self.getWatcher().sync('loading');
        $tenjoh.XHR.get({
            url: sprintf('/user/?userNo=%d&castName=%s&asId=%d&action=admin', self.userNo, castName, asId),
            cashe: true,
            success: function(responseText) {
                var userInfo = JSON.parse(responseText);
                self.user = userInfo.object;
                self.userNo = self.user.no;
                self.shifts = userInfo.club.shift;
                self.manages = userInfo.club.manage;
                self.errorMessage = '';
                self.loading = false;
                self.getWatcher().sync('autoBindFlag');
                self.getWatcher().sync('user');
                self.getWatcher().sync('shifts');
                self.getWatcher().sync('manages');
                self.getWatcher().sync('errorMessage');
                self.getWatcher().sync('loading');
                $tenjoh.UI.createPartial('Status', '/admin/user/avatar.html', document.getElementById('status'), { userNo: self.userNo });
            },
            error: function(responseText) {
<<<<<<< HEAD
                self.errorMessage = '※ユーザーが見つかりません。';
                self.loading = false;
                self.getWatcher().sync('errorMessage');
                self.getWatcher().sync('loading');
            }
=======
                self.errorMessage = 'ユーザーがみつかりません';
                self.loading = false;
                self.getWatcher().sync('errorMessage');
                self.getWatcher().sync('loading');
            },
>>>>>>> 94264d7691e80ac3a3d920ab7321a655f9ef8912
        });
    };
    self.load = function() {
        if (self.userNo != null) searchUser();
    };
    self.search = function() {
        self.userNo = document.getElementById('userNo').value;
        searchUser();
    };
};
</script>